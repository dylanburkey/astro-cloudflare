---
import Dashboard from '../../../layouts/Dashboard.astro';
import { getPreset } from '../../../lib/presets/apply';

const { slug } = Astro.params;

const preset = await getPreset(slug || '');

if (!preset) {
  return Astro.redirect('/library/presets');
}
---

<Dashboard title={preset.name} activeNav="presets">
  <div class="mb-6">
    <a href="/library/presets" class="inline-flex items-center gap-1 text-sm text-gray-500 hover:text-gray-700 mb-4">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      Back to Presets
    </a>

    <div class="flex items-start justify-between">
      <div>
        <h1 class="text-2xl font-bold text-gray-900 mb-2">{preset.name}</h1>
        <p class="text-gray-600">{preset.description}</p>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Colors -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200">
      <div class="px-6 py-4 border-b border-gray-200">
        <h2 class="text-lg font-semibold text-gray-900">Colors</h2>
      </div>
      <div class="p-6 space-y-4">
        {Object.entries(preset.colors).map(([key, value]) => (
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <div
                class="w-10 h-10 rounded-lg shadow-sm border border-gray-200"
                style={`background-color: ${value}`}
              ></div>
              <div>
                <p class="font-medium text-gray-900 capitalize">{key.replace(/_/g, ' ')}</p>
                <p class="text-sm text-gray-500 font-mono">{value}</p>
              </div>
            </div>
            <button
              onclick={`navigator.clipboard.writeText('${value}')`}
              class="text-sm text-gray-400 hover:text-gray-600"
            >
              Copy
            </button>
          </div>
        ))}
      </div>
    </div>

    <!-- Typography -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200">
      <div class="px-6 py-4 border-b border-gray-200">
        <h2 class="text-lg font-semibold text-gray-900">Typography</h2>
      </div>
      <div class="p-6 space-y-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="font-medium text-gray-900">Heading Font</p>
            <p class="text-sm text-gray-500 font-mono">{preset.typography.heading_font}</p>
          </div>
        </div>
        <div class="flex items-center justify-between">
          <div>
            <p class="font-medium text-gray-900">Body Font</p>
            <p class="text-sm text-gray-500 font-mono">{preset.typography.body_font}</p>
          </div>
        </div>
        <div class="flex items-center justify-between">
          <div>
            <p class="font-medium text-gray-900">Heading Scale</p>
            <p class="text-sm text-gray-500">{preset.typography.heading_scale}%</p>
          </div>
        </div>
        <div class="flex items-center justify-between">
          <div>
            <p class="font-medium text-gray-900">Body Scale</p>
            <p class="text-sm text-gray-500">{preset.typography.body_scale}%</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Buttons -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200">
      <div class="px-6 py-4 border-b border-gray-200">
        <h2 class="text-lg font-semibold text-gray-900">Buttons</h2>
      </div>
      <div class="p-6 space-y-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="font-medium text-gray-900">Border Radius</p>
            <p class="text-sm text-gray-500">{preset.buttons.border_radius}px</p>
          </div>
        </div>
        <div class="flex items-center justify-between">
          <div>
            <p class="font-medium text-gray-900">Vertical Padding</p>
            <p class="text-sm text-gray-500">{preset.buttons.padding_vertical}px</p>
          </div>
        </div>
        <div class="flex items-center justify-between">
          <div>
            <p class="font-medium text-gray-900">Horizontal Padding</p>
            <p class="text-sm text-gray-500">{preset.buttons.padding_horizontal}px</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Preview -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200">
      <div class="px-6 py-4 border-b border-gray-200">
        <h2 class="text-lg font-semibold text-gray-900">Preview</h2>
      </div>
      <div
        class="p-6"
        style={`background-color: ${preset.colors.background}`}
      >
        <h3
          class="text-xl font-bold mb-2"
          style={`color: ${preset.colors.text}`}
        >
          Sample Heading
        </h3>
        <p
          class="mb-4"
          style={`color: ${preset.colors.text_secondary}`}
        >
          This is sample body text that demonstrates how the preset colors and typography will look.
        </p>
        <button
          class="text-white font-medium transition-colors"
          style={`
            background-color: ${preset.colors.primary};
            border-radius: ${preset.buttons.border_radius}px;
            padding: ${preset.buttons.padding_vertical}px ${preset.buttons.padding_horizontal}px;
          `}
        >
          Sample Button
        </button>
      </div>
    </div>
  </div>

  <!-- JSON Output -->
  <div class="mt-6 bg-white rounded-xl shadow-sm border border-gray-200">
    <div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between">
      <h2 class="text-lg font-semibold text-gray-900">Preset JSON</h2>
      <button
        onclick="navigator.clipboard.writeText(document.getElementById('preset-json').textContent)"
        class="text-sm text-emerald-600 hover:text-emerald-700 font-medium"
      >
        Copy
      </button>
    </div>
    <div class="p-6">
      <pre id="preset-json" class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm"><code>{JSON.stringify(preset, null, 2)}</code></pre>
    </div>
  </div>
</Dashboard>
